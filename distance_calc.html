<!DOCTYPE html>
<html>
  <head> 
	  
	<link rel="stylesheet" type="text/css" href="style.css">
	  
	<script type="text/javascript">

        function to_rad(deg){
            return deg*Math.PI/180
        }
        
        function solve_haversine(angle_rad){
            return Math.pow(Math.sin(angle_rad/2),2)
        }
        
        function solve_distance(){
	    var lat_1_rad = to_rad(document.getElementById("lat_dec_1").value);
	    var lon_1_rad = to_rad(document.getElementById("lon_dec_1").value);
	    var lat_2_rad = to_rad(document.getElementById("lat_dec_2").value);
	    var lon_2_rad = to_rad(document.getElementById("lon_dec_2").value);
            var earth_rad_km = 6371
            var hav_lat = solve_haversine(lat_2_rad-lat_1_rad)
            var hav_lon = solve_haversine(lon_2_rad-lon_1_rad)
	    var dist_km = (2*earth_rad_km*Math.asin(Math.sqrt(hav_lat+Math.cos(lat_1_rad)*Math.cos(lat_2_rad)*hav_lon)))
            var dist_ele = document.getElementById("dist_unit")
	    var dist_unit = dist_ele.options[dist_ele.selectedIndex].value
	    if (dist_unit == "km") {
	        document.getElementById("distance").value = dist_km.toString()
	    } else if (dist_unit == "mi"){
	    	document.getElementById("distance").value = (dist_km*0.621371).toString()
	    } else if (dist_unit == "m"){
		document.getElementById("distance").value = (dist_km*1000).toString()
	    } else if (dist_unit == "ft"){
		document.getElementById("distance").value = (dist_km*3280.838879).toString()
	    }
		
	    to_geojson();
	    to_wkt();
        }
                
        function to_wkt(){
	    var lat_1_dec = document.getElementById("lat_dec_1").value;
	    var lon_1_dec = document.getElementById("lon_dec_1").value;
	    var lat_2_dec = document.getElementById("lat_dec_2").value;
	    var lon_2_dec = document.getElementById("lon_dec_2").value;
		
            document.getElementById("wkt_out").value = "LINESTRING(" + lon_1_dec +" "+ lat_1_dec +", "+ lon_2_dec +" "+ lat_2_dec+")";
        }

        function to_geojson() {
	    var lat_1_dec = document.getElementById("lat_dec_1").value;
	    var lon_1_dec = document.getElementById("lon_dec_1").value;
	    var lat_2_dec = document.getElementById("lat_dec_2").value;
	    var lon_2_dec = document.getElementById("lon_dec_2").value;
            var geojson = {
                "type":"FeatureCollection",
                "features":[{
                "type":"Feature",
                "geometry":{
                "type":"LINESTRING",
                "coordinates":[]
                },
                "properties":null
                }]
            };
            
            geojson.features[0].geometry.coordinates.push([lon_1_dec, lat_1_dec]);
       	    geojson.features[0].geometry.coordinates.push([lon_2_dec, lat_2_dec]);
        
            document.getElementById("geojson_out").value = JSON.stringify(geojson);
        }

        function get_dec_w_dir(coord, neg_dir) {
            var dec_val = document.getElementById(coord + "_dec").value;
            var dec_dir = document.getElementById(coord + "_dec_dir").value.toUpperCase();
            if(dec_dir == neg_dir){
                dec_val *= -1;
            } else {
                dec_val *= 1;
            }        
            return dec_val
        }
       
        
	</script> 
</head> 
<!-- create table -->
<body> 

    <div class = title >Lat Long Converter</div> 

    <table border="1" style="width: 50%"> 
        <colgroup>
            <col span="1" style="width: 25%;">
            <col span="1" style="width: 25%;">
            <col span="1" style="width: 25%;">
            <col span="1" style="width: 25%;">
        </colgroup>
        
        <tr> 
            <td colspan="4">Location 1</td>
	</tr> 
        <tr>
	    <td>Latitude (dec)</td>
            <td><input type="number" name="lat_dec_1" id="lat_dec_1" value="0" min="-180" max="180" step="0.00000001"/></td>
            <td>Longitude (dec)</td>
            <td><input type="number" name="lon_dec_1" id="lon_dec_1" value="0" min="-180" max="180" step="0.00000001"/></td>
        </tr>
	<tr></tr>
        <tr> 
            <td colspan="4">Location 2</td>
	</tr> 
        <tr>
	    <td>Latitude (dec)</td>
            <td><input type="number" name="lat_dec_2" id="lat_dec_2" value="0" min="-180" max="180" step="0.00000001"/></td>
            <td>Longitude (dec)</td>
            <td><input type="number" name="lon_dec_2" id="lon_dec_2" value="0" min="-180" max="180" step="0.00000001"/></td>
        </tr>
        <tr></tr>
	<tr> 
        	<td></td>
        	<td colspan="2"><input type="button" value="Calculate" onclick="solve_distance()"/></td>
		<td></td>
        </tr> 
        <tr></tr>
	    
	
        <tr>
	    <td>Distance (km)</td>
            <td colspan="2"><input type="number" name="distance" id="distance" value="0.00000000" min="0.00000000" step="0.00000001"/></td>
            <td><select name="dist_unit" id="dist_unit" onchange="solve_distance()">
                <option value="km">km</option>
		<option value="mi">mi</option>
		<option value="m">m</option>
     		<option value="ft">ft</option>
            </select></td>
	</tr> 
	<tr> 
            <td>Well Known Text (WKT)</td>
	    <td colspan="3"><input type="text" name="wkt_out" id="wkt_out"/></td> 
	</tr> 
        <tr> 
            <td>GeoJSON</td>
	    <td colspan="3"><input type="text" name="geojson_out" id="geojson_out"/></td> 
	</tr> 
	</table> 
</body> 

</html>


